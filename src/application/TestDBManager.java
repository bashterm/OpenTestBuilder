package application;

import java.sql.*;
/**
 * Handles the creation and reading of test databases
 * 
 * @author Aidan Sciortino
 *
 */
public class TestDBManager {
	public TestDBManager(){
		
	}
	/**
	 * Creates a new database file and populates it with a table designed for multiple choice questions
	 * 
	 * @param fileName the file name of the created database
	 */
	public void createMultChoiceDB(String fileName){
    	String url = "jdbc:sqlite:" + fileName;
    	String sql = "CREATE TABLE IF NOT EXISTS questions (\n"
    			+ "id integer PRIMARY KEY, \n"
    			+ "prompt text NOT NULL, \n"
    			+ "ans1 text NOT NULL, \n"
    			+ "ans2 text NOT NULL, \n"
    			+ "ans3 text, \n"
    			+ "ans4 text, \n"
    			+ "ans5 text, \n"
    			+ "ans6 text, \n"
    			+ "ans7 text, \n"
    			+ "points integer NOT NULL);";
    	try (Connection conn = DriverManager.getConnection(url);
    			Statement stmnt = conn.createStatement()){
			if (conn != null){
				DatabaseMetaData meta = conn.getMetaData();
				System.out.println("The Driver Name is " + meta.getDriverName());
				System.out.println("A New database has been created");
			}
			stmnt.execute(sql);
			
		}catch (SQLException e){
			System.out.println(e.getMessage());
		}
    }
	/**
	 * Creates a new database file and populates it with a table based around extended response questions
	 * 
	 * @param fileName the file name of the created database
	 */
	public void createShortAnsDB(String fileName){
    	String url = "jdbc:sqlite:" + fileName;
    	String sql = "CREATE TABLE IF NOT EXISTS questions (\n"
    			+ "id integer PRIMARY KEY, \n"
    			+ "prompt text NOT NULL, \n"
    			+ "points integer NOT NULL);";
    	try (Connection conn = DriverManager.getConnection(url);
    			Statement stmnt = conn.createStatement()){
			if (conn != null){
				DatabaseMetaData meta = conn.getMetaData();
				System.out.println("The Driver Name is " + meta.getDriverName());
				System.out.println("A New database has been created");
			}
			stmnt.execute(sql);
			
		}catch (SQLException e){
			System.out.println(e.getMessage());
		}
    }
}
